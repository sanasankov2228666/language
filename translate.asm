PUSH 100
PUSH 0
POPM [AX]
PUSHM [AX]
POPREG BX

JUMP :main

:main

PUSHREG BX
PUSH 0
ADD
POPREG FX
PUSH 5
CALL :factorial
POPM [FX]

PUSHM [AX]
PUSH 1
ADD
POPM [AX]
PUSHREG BX
PUSH 0
ADD
POPREG FX
PUSHM [FX]

OUT
JUMP :end_program
:factorial

PUSHM [AX]
POPREG BX
PUSHREG AX
PUSH 1
ADD
POPREG AX
PUSHREG BX
POPM [AX]

PUSHREG BX
PUSH 0
ADD
POPREG FX
POPM [FX]

PUSHM [AX]
PUSH 1
ADD
POPM [AX]

PUSHREG BX
PUSH 1
ADD
POPREG FX
PUSH 1
POPM [FX]

PUSHM [AX]
PUSH 1
ADD
POPM [AX]

PUSHREG BX
PUSH 2
ADD
POPREG FX
PUSH 1
POPM [FX]

PUSHM [AX]
PUSH 1
ADD
POPM [AX]

PUSHM [AX]
POPREG BX
PUSHREG AX
PUSH 1
ADD
POPREG AX
PUSHREG BX
POPM [AX]

:while_start1
PUSHREG BX
PUSH 2
ADD
POPREG FX
PUSHM [FX]
PUSHREG BX
PUSH 0
ADD
POPREG FX
PUSHM [FX]

PUSH 0
POPREG CX
JB :cond_false1
PUSH 1
POPREG CX
JUMP :cond_end1
:cond_false1
PUSH 0
POPREG CX
:cond_end1
PUSHREG CX

PUSH 0
JE :endwhile1
PUSHREG BX
PUSH 1
ADD
POPREG FX
PUSHREG BX
PUSH 1
ADD
POPREG FX
PUSHM [FX]
PUSHREG BX
PUSH 2
ADD
POPREG FX
PUSHM [FX]
MULT
POPM [FX]
PUSHREG BX
PUSH 2
ADD
POPREG FX
PUSHREG BX
PUSH 2
ADD
POPREG FX
PUSHM [FX]
PUSH 1
ADD
POPM [FX]

JUMP :while_start1
:endwhile1

PUSH 1
PUSHREG AX
SUB
POPREG AX
PUSHM [AX]
POPREG BX
PUSHREG BX
PUSH 1
ADD
POPREG FX
PUSHM [FX]
RET

PUSH 1
PUSHREG AX
SUB
POPREG AX
PUSHM [AX]
POPREG BX
:end_program

HLT
